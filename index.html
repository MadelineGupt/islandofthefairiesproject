<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebXR Canoe Experience</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/donmccurdy/aframe-extras/master/dist/aframe-extras.min.js"></script>
</head>
<body>
    <a-scene>
        <!-- Asset Management for 360 Video -->
        <a-assets>
            <video id="vr-video" autoplay loop="true" crossorigin="anonymous" webkit-playsinline playsinline>
                <source src="" type="video/mp4">
            </video>
        </a-assets>

        <!-- Soft Sky Background -->
        <a-sky src="sky.jpg"></a-sky>

        <!-- 360Â° Video Sphere (Starts Hidden) -->
        <a-videosphere id="video-sphere" src="#vr-video" visible="false" rotation="0 180 0"></a-videosphere>

        <!-- Realistic Water -->
        <a-entity id="water"
                  geometry="primitive: plane; width: 200; height: 200"
                  rotation="-90 0 0"
                  position="0 0 -3"
                  material="color: #3d7d92; src: water-texture.jpg; shader: standard; metalness: 0.2; roughness: 0.3; opacity: 0.85;">
        </a-entity>

        <!-- Camera Rig with VR Movement -->
        <a-entity id="camera-rig" position="0 -0.5 0" movement-controls="constrainToNavMesh: true">
            <a-entity id="camera" camera position="0 .9 -.5" look-controls>
                <a-cursor color="black"></a-cursor>
            </a-entity>
        </a-entity>

        <!-- Floating Map -->
        <a-image id="map" src="map.png" position="0 2 -3" width="5" height="6"
                 material="shader: standard; metalness: 0.1; roughness: 0.8;"
                 animation="property: position; from: 0 2 -3; to: 0 2.1 -3; dur: 2000; dir: alternate; loop: true; easing: easeInOutSine">
        </a-image>

        <!-- Clickable Turtle Icons to Play 360 Video -->
        <a-entity position="0 2 -2.8">
            <a-image id="area1" src="turtle.png" position="-1 0.5 0.1" width="0.3" height="0.3"
                     class="clickable" look-at="#camera">
            </a-image>

            <a-image id="area2" src="turtle.png" position="1 1 0.1" width="0.3" height="0.3"
                     class="clickable" look-at="#camera">
            </a-image>
        </a-entity>
    </a-scene>

    <script>
        function play360Video(videoSrc) {
            let videoSphere = document.querySelector("#video-sphere");
            let videoElement = document.querySelector("#vr-video");

            videoElement.setAttribute("src", videoSrc);
            videoElement.play();
            videoSphere.setAttribute("visible", "true");
        }

        document.addEventListener("DOMContentLoaded", function () {
            document.querySelector("#area1").addEventListener("click", function () {
                play360Video("https://storage.googleapis.com/islandofthefairies/video1.mov");
            });

            document.querySelector("#area2").addEventListener("click", function () {
                play360Video("https://storage.googleapis.com/islandofthefairies/video2.mov");
            });
        });
    </script>
</body>
</html>
